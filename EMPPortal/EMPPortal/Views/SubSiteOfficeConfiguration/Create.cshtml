@using EMPPortal.Filters;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <input type="hidden" id="formid" name="formid" value="active" formid="site1f2a6418-f9bc-4878-ab0b-2fa004c01c01" sitemapid="1f2a6418-f9bc-4878-ab0b-2fa004c01c01" />
    <div class="row" id="divSubSiteOfficeCustInfoCreateForm">
        <div class="office-pg">
            <h2>Sub-site Office Information</h2>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="form-horizontal">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        <input type="hidden" id="Id" value="@Request.QueryString["Id"]" />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Company Name</label>
                                    <div class="col-md-8">
                                        <input type="text" id="CompanyName" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <div class="col-md-4">
                                        <label for="inputEmail" class="control-label mandatory">
                                            EFIN
                                        </label>
                                        <span class="cst-tooltip"><a class="ttip" id="ttipefeb4e15-e01a-4243-80b7-5f709b1ce3b3" style="display:none;" href="#" data-toggle="tooltip" data-placement="right" title="" data-original-title="Tooltip"><i class="fa fa-info" aria-hidden="true"></i></a></span>
                                    </div>

                                    <div class="col-md-3">
                                        <select id="EFINStatus" name="EFINStatus" class="form-control"></select>
                                    </div>
                                    <div class="col-md-5">
                                        <input type="text" id="EFIN" class="form-control" maxlength="6">
                                    </div>
                                </div>
                            </div>
                            @*<div class="col-md-6">
                                    <div class="form-group">
                                        <label for="inputEmail" class="col-md-4 control-label">ParentID</label>
                                        <div class="col-md-8">
                                            <input type="text" id="SalesforceParentID" class="form-control alphanumaric" readonly="readonly">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="inputEmail" class="col-md-4 control-label">Master Identifier</label>
                                        <div class="col-md-8">
                                            <input type="text" id="MasterIdentifier" class="form-control" readonly="readonly">
                                        </div>
                                    </div>
                                </div>*@
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-md-4 control-label mandatory">Business Owner First Name</label>
                                    <div class="col-md-8">
                                        <input type="text" id="BusinessOwnerFirstName" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-md-4 control-label mandatory">Business Owner Last Name</label>
                                    <div class="col-md-8">
                                        <input type="text" id="BusinessOwnerLastName" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">

                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Title</label>
                                    <div class="col-md-8">
                                        <select id="TitleId" name="TitleId" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Office Phone</label>
                                    <div class="col-md-8">
                                        <input type="text" id="OfficePhone" class="form-control digit" maxlength="15">
                                        @*<input type="hidden" id="AlternatePhone" class="form-control">*@
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Phone Type</label>
                                    <div class="col-md-8">
                                        <select id="PhoneTypeId" name="PhoneTypeId" class="form-control"></select>
                                    </div>
                                </div>
                            </div>


                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Primary Email</label>
                                    <div class="col-md-8">
                                        <input type="text" id="Primaryemail" class="form-control" maxlength="99">
                                        <input type="hidden" id="EROType">
                                        <input type="hidden" id="AlternativeContact">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Support Notification Email</label>
                                    <div class="col-md-8">
                                        <input type="text" id="SupportNotificationemail" class="form-control" maxlength="99">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Alternate Telephone Number</label>
                                    <div class="col-md-8">
                                        <input type="text" id="AlternatePhone" class="form-control" maxlength="15">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Alternate Phone Type</label>
                                    <div class="col-md-8">
                                        <select id="AlternatePhoneTypeId" name="AlternatePhoneTypeId" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Alternate Contact Name</label>
                                    <div class="col-md-8">
                                        <input type="text" id="AlternativeContact" maxlength="50" class="form-control" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Alternate Contact Type</label>
                                    <div class="col-md-8">
                                        <select id="AlternativeTypeId" name="AlternativeTypeId" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                &nbsp;
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Physical Address 1</label>
                                    <div class="col-md-8">
                                        <input type="text" id="PhysicalAddress1" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Physical Address 2</label>
                                    <div class="col-md-8">
                                        <input type="text" id="PhysicalAddress2" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>


                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Physical City</label>
                                    <div class="col-md-8">
                                        <input type="text" id="PhysicalCity" class="form-control" maxlength="49">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Physical State</label>
                                    <div class="col-md-8">
                                        @*<input type="text" id="PhysicalState" class="form-control">*@
                                        <select id="PhysicalStateID" name="PhysicalStateID" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label mandatory">Physical Zip Code</label>
                                    <div class="col-md-8">
                                        <input type="number" id="PhysicalZipcode" class="form-control" maxlength="5" max="99999" onkeypress="Onlydigit(event)"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <div class="checkbox shipping-address">
                                        <label>
                                            <input type="checkbox" id="ShippingAddressSameAsPhysicalAddress" onchange="fnIsShippingSameAsPhysical();"> Shipping Address Same As Physical Address
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Shipping Address 1</label>
                                    <div class="col-md-8">
                                        <input type="text" id="ShippingAddress1" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Shipping Address 2</label>
                                    <div class="col-md-8">
                                        <input type="text" id="ShippingAddress2" class="form-control alphanumaric" maxlength="30">
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Shipping City</label>
                                    <div class="col-md-8">
                                        <input type="text" id="ShippingCity" class="form-control" maxlength="49">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Shipping State</label>
                                    <div class="col-md-8">
                                        <select id="ShippingStateID" name="ShippingStateID" class="form-control"></select>
                                    </div>
                                </div>
                            </div>


                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputEmail" class="col-md-4 control-label">Shipping Zip Code</label>
                                    <div class="col-md-8">
                                        <input type="number" id="ShippingZipcode" class="form-control" maxlength="5" max="99999" onkeypress="Onlydigit(event)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row margin-top-20">
                        <div class="col-md-4">
                            <div class="form-group">
                                <div class="col-md-12">
                                    <a value="Submit" class="btn btn-default" onclick="fnSaveCustomerInformation();" id="btn_save">Save</a>
                                    <a class="btn btn-back" id="btnback" onclick="goBackButton()">Back</a>
                                </div>
                            </div>
                            @if (Convert.ToInt32(Session["entityid"]) != (int)EMPPortal.Utilities.EMPPortalConstants.Entity.uTax)
                            {
                            <div class="col-md-12 margin-top-20">
                                <label class="text-success">For EFIN or Business Owner Name changes, please contact uTax support.</label>
                            </div>
                            }
                        </div>
                        <div class="col-md-8" style="display:none;">
                            <div class="bank-option cst-create" id="divParentInfo">
                                <ul>
                                    <li>Master ID :<label id="lblMasterID"></label></li>
                                    <li>Parent Account :<label id="lblParentAccount"></label></li>
                                    <li>MSO Indicator :<label id="lblMSO"></label></li>
                                    <li>EFIN  :<label id="lblEFIN"></label></li>
                                    <li>Transmit Type:<label id="lblTransmitType"></label></li>
                                    <li>
                                        Bank  :<label id="lblBank"></label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@section scripts {
    @Html.IncludeVersionedJs("/Scripts/app/customerInformation.js")
}
<script>
    $(document).ready(function () {
        fnEFINReadonly();
        getTooltip();

        $("#OfficePhone").mask("999-999-9999");
        $("#AlternatePhone").mask("999-999-9999");

        var entityid = $('#entityid').val();
        var entitydisplayid = $('#entitydisplayid').val();


        //if (entitydisplayid == $('#Entity_uTax').val()) {
        //    $('input[type=text]').attr('readonly', 'readonly');
        //    $('select').attr('disabled', 'disabled');
        //    $('textarea').attr('readonly', 'readonly');
        //    $('input[type=checkbox]').attr('disabled', 'disabled');
        //}

        var parentid = $('#parentid').val();
        var UserId = $('#UserId').val();
        if ($('#entityid').val() != $('#myentityid').val()) {
            UserId = $('#myid').val();
            parentid = $('#myparentid').val();
        }

        var myentityid = $('#myentityid').val();
        getEFINStatus($('#EFINStatus'), myentityid);

        getPhoneType($('#PhoneTypeId'), $('#AlternatePhoneTypeId'));
        getAlternativeTitle($('#AlternativeTypeId'));
        getTitle($('#TitleId'));
        getStateMasterCode($('#PhysicalStateID'), $('#ShippingStateID'));

        var Id = $('#Id').val();
        getCustomerInformation(Id);
        getBankEnrollmentStatusofCustomer(Id);

        //if ($('#h_subsiteId').length > 0) {

        //   // var Id = $('#h_subsiteId').val();

        //    $('#btn_back').attr('href', '/SubSiteOfficeConfiguration/Dashboard?Id=' + UserId + '&ParentId=' + parentid);

        //    getCustomerInformation(UserId);


        //    //
        //    if (entityid != $('#Entity_uTax').val()) {
        //        $('#CompanyName').attr('readonly', 'readonly');
        //        $('#EFIN').attr('readonly', 'readonly');
        //        $('#BusinessOwnerFirstName').attr('readonly', 'readonly');
        //    }
        //}
        //else {
        //    var Id = $('#Id').val();
        //    getCustomerInformation(Id);
        //}
    });

    $(function () {
        $('#PhysicalZipcode').keyup(function (e) {
            if ($(this).val().length == 5) {
                var value = $(this).val();
                var custmorUri = '/api/ZipCode?id=' + value;
                ajaxHelper(custmorUri, 'GET').done(function (data) {
                    if (data) {
                        $('#PhysicalStateID').val(data["State"]);
                        $('#PhysicalCity').val(data["City"]);
                    }
                });
            }
            else if ($(this).val().length > 5) {
                var xp = $(this).val();
                $(this).val(xp.substr(0, 5));
            }
        });

        $('#ShippingZipcode').keyup(function (e) {
            if ($(this).val().length == 5) {
                var value = $(this).val();
                var custmorUri = '/api/ZipCode?id=' + value;
                ajaxHelper(custmorUri, 'GET').done(function (data) {
                    if (data) {
                        $('#ShippingStateID').val(data["State"]);
                        $('#ShippingCity').val(data["City"]);
                    }
                });
            }
            else if ($(this).val().length > 5) {
                var xp = $(this).val();
                $(this).val(xp.substr(0, 5));
            }
        });
    })


    function goBackButton() {
        window.location.href = document.referrer;
    }
</script>
